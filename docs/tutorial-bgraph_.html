<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Documentation Tutorial: Using the bgraph class</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.simplex.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Documentation</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-beebrain.html">beebrain</a></li><li><a href="module-bgraph.html">bgraph</a></li><li><a href="module-broad.html">broad</a></li><li><a href="module-bsandbox.html">bsandbox</a></li><li><a href="module-butil.html">butil</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="beebrain.html">beebrain</a></li><li><a href="bgraph.html">bgraph</a></li><li><a href="bsandbox.html">bsandbox</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-beebrain_.html">Using the beebrain class</a></li><li><a href="tutorial-bgraph_.html">Using the bgraph class</a></li><li><a href="tutorial-bgraph_internals.html">Internal details for the bgraph class</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html">Global</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>Using the bgraph class</h2>
</header>

<article>
    <p>This tutorial describes the details and usage of the <a href="bgraph.html">bgraph</a>
class provided as part of the Beeminder Javascript implementation.</p>
<h3>Basic Usage for Interactive Graphs</h3><p>The <a href="module-bgraph.html">bgraph module</a> and the associated <a href="bgraph.html">bgraph class</a> allows programmers to create beeminder graph and
road table objects rendered within particular div objects within a web
page. Assuming that the required modules (d3, moment, polyfit,
pikaday, butil, broad, beebrain) are preloaded, the following code
illustrates the most basic usage</p>
<pre class="prettyprint source lang-javascript"><code>  var graph = new bgraph({divGraph: document.getElementById('graph'),
                          svgSize: { width: 800, height: 600 },
                          focusRect: { x:0, y:0, width:800, height: 453 },
                          ctxRect: { x:0, y:453, width:800, height: 100 },
                          showContext: true})
  graph.loadGoal( &quot;/path/slug.bb&quot; )</code></pre><p>This creates an interactive svg element within the supplied div
element, containing all graph components. These include the graph
itself and a &quot;context&quot; graph that shows the entire range of the goal
for the above example.  It is important that you specify the width and
height styles of the div element that will contain the graph with</p>
<pre class="prettyprint source lang-html"><code>&lt;div id=&quot;graph&quot; style=&quot;width:800px; height:600px&quot;>&lt;/div></code></pre><p>The <a href="bgraph.html">bgraph constructor</a> accepts an options argument with
type <a href="global.html#BGraphOptions">BGraphOptions</a>, whose components control the behavior of
the generated graph. In particular, the <strong>divGraph</strong>, <strong>divJSON</strong> and
<strong>divTable</strong> options specify container div elements for the graph,
goal json output and a road matrix table, respectively. A page with
all three features enabled would look like the following image:</p>
<center><img src="graph_example.png"></center>

<h3>Basic Usage for Road Editing</h3><p>Similar to its usage to generate interactive graphs, the <a href="bgraph.html">bgraph class</a> also allows programmers to create an interactive road
editor that allows both manipulation of the road on the graph, as well
as edits on the road matrix through the table. To this end, the
following Javascript code creates the editor on an existing div
element on the page:</p>
<pre class="prettyprint source lang-javascript"><code>  var graph = new bgraph({divGraph: document.getElementById('editor'),
                          svgSize: { width: 800, height: 600 },
                          focusRect: { x:0, y:0, width:800, height: 453 },
                          ctxRect: { x:0, y:453, width:800, height: 100 },
                          roadEditor: true,
                          showContext: true})
  graph.loadGoal( &quot;/path/slug.bb&quot; )</code></pre><p>This populates the supplied div element with the following content,
including the interactive editor and the editable road matrix. The
JSON output was excluded since editing the graph will change its
contents.</p>
<center><img src="editor_example.png"></center>

<p>Below is an explanation of various components and features of this editor:</p>
<p>Manipulating the road:</p>
<ul>
<li>The gray vertical lines (&quot;knots&quot;) on the graph allow moving left/right the inflection points in the road, changing their time,</li>
<li>The &quot;dots&quot; on the road allow moving up/down the inflection points on the road, changing their time,</li>
<li>The lines connecting the black dots (&quot;road segments&quot;) can also be grabbed and moved, allowing the user to change the slope of road segments,</li>
<li>The 'x' buttons on top of each knot allow deletion of the corresponding knot, removing the associated inflection point on the road,</li>
<li>You can left double click to create a new inflection point (knot/dot pair) on the road</li>
<li>The road line appears to be black when it is &quot;valid&quot; (i.e. does not intersect the pink region), and appears to be red when it is &quot;invalid&quot; (i.e. intersects the pink region),</li>
</ul>
<p>Visual indicators:</p>
<ul>
<li>Datapoints for the goal are shown as small circles,</li>
<li>The pink area below the graph shows the &quot;forbidden area&quot; up until a week from now, which the edited road is not allowed to intersect to remain valid,</li>
<li>When you &quot;select&quot; any knot, dot or segment with a single left mouse click, the corresponding entry in the road matrix table will be highlighted and corresponding date,value,slope values displayed on tooltips,</li>
</ul>
<p>Moving around and zooming:</p>
<ul>
<li>You can zoom in/out with the scroll wheel on the mouse, and drag the graph left/right to focus on different time periods on the graph,</li>
<li>The y-axis range for the graph is automatically computed to make all relevant components on the graph visible,</li>
<li>The &quot;context&quot; graph at the bottom shows the entire range of the graph, together with the current area spanned by the top &quot;focus&quot; graph. You can move around and scale the blue region to change the focus area.</li>
</ul>
<p>Road matrix table:</p>
<ul>
<li>Each row in this table shows three fields, end date, end value and slope, associated with the preceding segment. Only two of the three fields are &quot;active&quot;, with the third one inferred to be consistent with the rest of the road,</li>
<li>Selecting any of the active fields highlights the corresponding knot, dot or segment on the graph,</li>
<li>Selecting an inactive field activates it, but deactivates one of the previously active fields. You can hence determine which field from among the three should be inferred automatically,</li>
<li>You can delete a road matrix row by using the &quot;del&quot; button,</li>
<li>A new segment can be added using the &quot;add&quot; button, created in between the row with the button and the next</li>
</ul>
<p>These components allow the user to change any and all aspects of the
road associated with a beeminder goal.</p>
<h3>Common Functions for both Graphs and the Editor</h3><ul>
<li><a href="bgraph.html#loadGoal">bgraph#loadGoal</a>(url): Async function that loads the BB file from the indicated URL and starts rendering the graph. Completion of rendering might take some time, at the end of which the callback function specified in the <em>onRoadChange</em> property of <a href="global.html#BGraphOptions">BGraphOptions</a> will be called.</li>
<li><a href="bgraph.html#loadGoalJSON">bgraph#loadGoalJSON</a>(json): Function to load goal contents from a BB json start rendering the graph. Completion of rendering might take some time, at the end of which the callback function specified in the <em>onRoadChange</em> property of <a href="global.html#BGraphOptions">BGraphOptions</a> will be called. <strong>TODO: CHECK if onRoadChange is indeed called here</strong></li>
<li><a href="bgraph.html#zoomAll">bgraph#zoomAll</a>(): Zooms out to show the entire graph range</li>
<li><a href="bgraph.html#zoomDefault">bgraph#zoomDefault</a>(): Zooms into the default range for the graph</li>
<li><a href="bgraph.html#hide">bgraph#hide</a>() and <a href="bgraph.html#show">bgraph#show</a>(): Should be called when the div containing the graph/editor is hidden and reshown on the page.</li>
<li><a href="bgraph.html#showContext">bgraph#showContext</a>(flag): Show/hide the context graph</li>
<li><a href="bgraph.html#maxDataDays">bgraph#maxDataDays</a>(days): Set the maximum number of days before today to show datapoints for. Defaults to 365 unless specified in the initial options. Helps optimize interactivity performance.</li>
<li><a href="bgraph.html#reverseTable">bgraph#reverseTable</a>(flag): Sets whether the road matrix table should be sorted in decreasing (true), or increasing (false) order of dates. Final road row is placed at the top if set to true.</li>
<li><a href="bgraph.html#getRoad">bgraph#getRoad</a>(): </li>
<li><a href="bgraph.html#getRoadObj">bgraph#getRoadObj</a>(): </li>
<li><a href="bgraph.html#setRoadObj">bgraph#setRoadObj</a>(): </li>
<li><a href="bgraph.html#isLoser">bgraph#isLoser</a>(): </li>
<li><a href="bgraph.html#curState">bgraph#curState</a>(): </li>
<li><a href="bgraph.html#saveGraph">bgraph#saveGraph</a>(linkelt): </li>
<li><a href="bgraph.html#getVisualConfig">bgraph#getVisualConfig</a>(): </li>
<li><a href="bgraph.html#getGoalConfig">bgraph#getGoalConfig</a>(): </li>
</ul>
<h3>Functions Specific to the Editor</h3><ul>
<li><a href="bgraph.html#showData">bgraph#showData</a>(flag): Show/hide datapoints on the editor graph. Datapoins are always shown on the interactive non-editor graph.</li>
<li><a href="bgraph.html#keepSlopes">bgraph#keepSlopes</a>(flag): </li>
<li><a href="bgraph.html#keepIntervals">bgraph#keepIntervals</a>(flag): </li>
<li><a href="bgraph.html#tableAutoScroll">bgraph#tableAutoScroll</a>(flag): </li>
<li><a href="bgraph.html#undo">bgraph#undo</a>(): </li>
<li><a href="bgraph.html#redo">bgraph#redo</a>(): </li>
<li><a href="bgraph.html#undoBufferState">bgraph#undoBufferState</a>(): </li>
<li>bgraph#clearUndoBuffer(): </li>
<li><a href="bgraph.html#retroRatchet">bgraph#retroRatchet</a>(days): </li>
<li><a href="bgraph.html#scheduleBreak">bgraph#scheduleBreak</a>(start, days, insert): </li>
<li><a href="bgraph.html#commitTo">bgraph#commitTo</a>(newSlope): </li>
</ul>
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>