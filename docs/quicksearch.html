<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Global Type Definitions BGraphOptions Type: object Properties: Name Type Description noGraph boolean Generates an empty graph and JSON if true headless Boolean Strips the graph of all details except what is needed for svg output. roadEditor Boolean Enables the road editor. When disabled, the generated graph mirrors beebrain output as closely as possible. divJSON object Binds the goal JSON output to a div element divGraph object Binds the graph to a div element svgSize object Size of the SVG element to hold the graph e.g. { width: 700, height: 450 } focusRect object Boundaries of the SVG group to hold the focus graph e.g. { x:0, y:0, width:700, height: 370 } focusPad object Initial padding within the focus graph e.g. { left:25, right:5, top:25, bottom:30 } ctxRect object Boundaries of the SVG group to hold the context graph e.g. { x:0, y:370, width:700, height: 80 } ctxPad object Initial padding within the context graph e.g. { left:25, right:5, top:0, bottom:30 } scrollZoom Boolean Enables zooming by scrollwheel. When disabled, only the context graph and the zoom buttons will allow zooming. showContext Boolean Enables the display of the context graph within the SVG showFocusRect Boolean Enables showing a dashed rectange in the context graph visualizing the current graph limits on the y-axis keepSlopes Boolean Indicates whether slopes for segments beyond the currently dragged element should be kept constant during editing. keepIntervals Boolean Indicates whether intervals between the knots for segments beyond the currently dragged element should be kept constant during editing. showData Boolean Enables displaying datapoints on the graph maxDataDays Integer When datapoint display is enabled, indicates the number of days before asof to show data for. This can be used to speed up display refresh for large goals. Choose -1 to display all datapoints. Choose -1 to show all points. maxFutureDays Integer Indicates how many days beyond asof should be included in the fully zoomed out graph. This is useful for when the goal date is too far beyond asof, making the context graph somewhat useless in terms of its interface utility. divTable object Binds the road table to a div element tableHeight Number Height of the road matrix table. Choose 0 for unspecified tableCheckboxes Boolean Chooses whether the road matrix table should include checkboxes for choosing the field to be automatically computed. reverseTable Boolean Indicates whether the road matrix table should be shown with the earliest rows first (normal) or most recent rows first(reversed). tableAutoScroll Boolean Indicates whether the auto-scrolling feature for the road matrix table should be enabled such that when the mouse moves over knots, dots or road elements, the corresponding table row is scrolled to be visible in the table. This is particularly useful when tableHeight is explicitly specified and is nonzero. tableUpdateOnDrag Boolean Chooses whether the road matrix table should be dynamically updated during the dragging of road knots, dots and segments. Enabling this may induce some lagginess, particularly on Firefox due to more components being updated during dragging onRoadChange function Callback function that gets invoked when the road is finished loading or has been edited by the user. Various interface functions can then be used to retrieve the new road state. This is also useful to update the state of undo/redo and submit buttons based on how many edits have been done on the original road. onError function Callback function that gets invoked when an error is encountered in loading, processing, drawing or editing the road. zoomButton object Visual parameters for the zoom in/out buttons. \"factor\" indicates how much to zoom in/out per click. e.g. { size: 40, opacity: 0.6, factor: 1.5 } bullsEye object Size of the bullseye image in the focus and context graphs e.g. { size: 40, ctxsize: 20 } roadDot object Visual parameters for draggable road dots e.g. { size: 5, ctxsize: 3, border: 1.5, ctxborder: 1 } roadKnot object Visual parameters for draggable road knots and removal buttons e.g. { width: 3, rmbtnscale: 0.6 } roadLine object Visual parameters for draggable road lines e.g. { width: 3, ctxwidth: 2 } oldRoadLine object Visual parameters for fixed lines for the original road e.g. { width: 3, ctxwidth: 2, dash: 32, ctxdash: 16 } dataPoint object Visual parameters for data points (past, flatlined and hollow) e.g. { size: 5, fsize: 5, hsize: 2.5 } horizon object Visual parameters for the akrasia horizon e.g. { width: 2, ctxwidth: 1, dash: 8, ctxdash: 6, font: 12, ctxfont: 9 } today object Visual parameters for vertical line for asof e.g. { width: 2, ctxwidth: 1, font: 12, ctxfont: 9 } watermark object Visual parameters for watermarks e.g. { height:170, fntsize:130 } guidelines object Visual parameters for guidelines e.g. { width:2, weekwidth:4 } textBox object Visual parameters for text boxes shown during dragging e.g. { margin: 3 } odomReset object Visual parameters for odometer resets e.g. { width: 0.5, dash: 8 } roadLineCol object Colors for road segments for the editor, e.g. { valid: \"black\", invalid:\"#ca1212\", selected:\"yellow\"} roadDotCol object Colors for the road dots for the editor, e.g. { fixed: \"darkgray\", editable:\"#c2c2c2\", selected: \"yellow\"} roadKnotCol object Colors for the road knots (vertical) for the editor, e.g. { dflt: \"#c2c2c2\", selected: \"yellow\", rmbtn: \"black\", rmbtnsel: \"red\"} textBoxCol object Colors for text boxes e.g. { bg: \"#ffffff\", stroke:\"#d0d0d0\"} roadTableCol object Colors for the road table e.g. { bg:\"#ffffff\", bgHighlight: \"#fffb55\", text:\"#000000\", textDisabled: \"#aaaaaa\", bgDisabled:\"#f2f2f2\"} dataPointCol object Colors for datapoints, e.g. { future: \"#909090\", stroke: \"lightgray\"} halfPlaneCol object Colors for the yellow brick half plane. e.g. { fill: \"#ffffe8\" } pastBoxCol object Colors for the past, e.g. { fill: \"#f8f8f8\", opacity:0.5 } odomResetCol object Colors for odometer reset indicators, e.g. { dflt: \"#c2c2c2\" } GoalProperties Type: object Properties: Name Type Description offred Boolean Whether to use yesterday-is-red criteria for derails yaw Boolean Which side of the YBR you want to be on, +1 or -1 dir Boolean Which direction you'll go (usually same as yaw) kyoom Boolean Cumulative; plot vals as the sum of those entered so far odom Boolean Treat zeros as accidental odom resets noisy Boolean Compute road width based on data, not just road rate integery Boolean Whether vals are necessarily integers monotone Boolean Whether data is necessarily monotone aggday String sum/last/first/min/max/mean/median/mode/trimmean/jolly GoalVisuals Type: object Properties: Name Type Description plotall Boolean Plot all points instead of just the aggregated point steppy Boolean Join dots with purple steppy-style line rosy Boolean Show the rose-colored dots and connecting line movingav Boolean Show moving average line superimposed on the data aura Boolean Show blue-green/turquoise aura/swath hidey Boolean Whether to hide the y-axis numbers stathead Boolean Whether to include label with stats at top of graph hashtags Boolean Show annotations on graph for hashtags in comments × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Modules Classes beebrain bgraph bsandbox × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Classes Classes beebrain bgraph bsandbox × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Tutorials Classes beebrain bgraph bsandbox × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Beebrain and the Beeminder Road EditorThis repository includes Javascript packages implementing all Beebrain functionality, as well as an interactive editor for Beeminder's Yellow Brick Roads. Description of original Beebrain: http://doc.beeminder.com/beebrain Components and Features Javascript modules for processing Beeminder goal BB files (butil, broad, beebrain) A Javascript module for goal graph generation and an interactive road editor (bgraph) A Javascript module implementing a sandbox for experimenting with Beemidner goals (bsandbox) A Javascript module to facilitate automated testing and comparison of beebrain outputs (btest) A Node server that uses the modules above to locally generate graph PNG and SVG, thumbnail PNG, and goal JSON output files upon receiving a GET request A Node server that provides a web interface for client-side graphs, road editor, and sandbox functionality A Node server that duplicates the behaviors of sanity.py from pybrain Various static HTML pages to test beebrain, graph, editor and sandbox functionality Getting startedFirst make an environment variable with the path to this repository, for example: export BBPATH=/Users/alice/projects/road (Or wherever you git-cloned this to.) You can put that in your .bashrc if you want. Or just edit in your path wherever it says $BBPATH below. Local tests for basic functionalityThe directory tests has HTML files illustrating various Beebrain functionality: basic_test.html : Showcases client-side graphs roadeditor_test.html : Showcases client-side graphs and the road editor sandbox.html : Showcases a Beeminder sandbox to create and experiment with goals You can load them in Chromium or Chrome with the following command: (Chromium on Linux)chromium-browser --allow-file-access-from-files --disable-web-security --user-data-dir=$BBPATH/chromium-data --remote-debugging-port=9222 --use-gl=osmesa file://$BBPATH/tests/basic_test.html file://$BBPATH/tests/roadeditor_test.html file://$BBPATH/tests/sandbox.html (Chrome on MacOS)open -na /Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome --args --allow-file-access-from-files --disable-web-security --user-data-dir=$BBPATH/chromium-data --remote-debugging-port=9222 --use-gl=osmesa file://$BBPATH/tests/basic_test.html file://$BBPATH/tests/roadeditor_test.html file://$BBPATH/tests/sandbox.html The scary-looking arguments allow the browser to open local Beeminder files from within Javascript functions. Node server for client-side graphs, road editor, and sandbox demosThis repository contains a Node server instance for serving various demo pages to browser clients. After you clone this repository, install necessary Node modules in the root directory: npm update Once all module dependencies are installed, generate minified and concatanated files based on sources in src. To do that, you may need to first install the command line interface for Gulp: sudo npm install --global gulp-cli which now enables you to use the gulp command. Now, you can generate all distribution files with gulp compile After updating Node modules and using Gulp to compile js modules, you will need to provide a .data directory with a local sqlite database and a .env file with proper server settings to access central Beeminder servers for your login (contact us for details). Once this is done, you can start the demo server with npm start This starts a web server on localhost, with different features available through different paths. This server should also be embeddable in Glitch. The following paths are available: /editor : Client-side graph and interactive road editor for example goals /sandbox : Client-side sandbox to create and experiment with dummy goals /login : Authorizes these pages to access your Beeminder goals /logout : De-authorizes access to your Beeminder goals /road : Client-side graph and interactive road editor for your Beeminder goals The last three require setting up oauth redirect uri configuration properly with beeminder servers, so it would require proper settings in .env. The first two should work locally though. Note that getting the last three to work requires the Node server being accessible from beeminder servers for the redirect_uri provided in .env, associated with the clientid also configured in .env. Node server for local server-side graph generationThis feature enables running a separate Node.js instance on a server, listening to GET requests that initiate the generation of PNG,SVG and JSON files for particular beeminder goals. This server resides under the directory jsbrain_server. You should first update Node modules with cd jsbrain_server npm update At this point, you can start the server in the same directory with npm start which should start a Node server on port 3000. At this point, every GET request you issue to localhost:3000 with appropriate parameters will initiate graph generation. valid parameters are: inpath=/path/to/input : Path to local directory for the BB file outpath=/path/to/output: (optional) Path to local directory for generated files user=u: beeminder username (slug param must be empty) goal=g: beeminder goalname (slug param must be empty) slug=filebase: base name for the BB files (user and goal params must be empty) pyjson=/path/to/pyout/slug.json: (optional) Local path to pybrain JSON output This reads the file u+g.bb (or slug.bb) from /path/to/input, and generates u+g.png, u+g-thumb.png, u+g.svg and u+g.json in /path/to/output. AppendicesA. Directory structureThe directory structure for this repository is organized as follows src : Javascript and CSS sources lib : Files generated and copied by gulp, served under /lib data: Example BB files, accessible through /data views: express.js view templates tests: HTML files for various local tests, loading scripts from src jsbrain_server:Local server to handle graph generation requests jsbrain_manual:Outdated manual shell script for PNG generation Emacs environment: indium works well sr-speedbar is docked imenu requires rescan from the top menu M-x indium-connect connects to a running chrom instance configured in the .indium file Had to rename menu names in js2 and indium el files to shorten their names purpose-mode is useful to keep windows with what they are for For development, the following fonts seem to be good options: Hack: https://github.com/source-foundry/Hack OfficeCodePro: https://github.com/nathco/Office-Code-Pro Font rendering: https://wiki.manjaro.org/index.php?title=Improve_Font_Rendering B. Deployment to glitch, or local serverWhen deploying a new version of the road editor to glitch (as in setting up a new road-staging glitch) create a new beeminder client at https://www.beeminder.com/apps/new the redirect uri is https://[project].glitch.me/connect add the client id to your .env file add the redirect uri in your .env file launch the glitch console and create .data/database.sqlite for the session store to connect to × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"beebrain.html":{"id":"beebrain.html","title":"Class: beebrain","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Class: beebrain beebrain beebrain new beebrain(bbin) beebrain object constructor. Processes the supplied goal information JSON and computed derived goal parameters, summaries and other details. These results can be accessed through various public members and methods. Parameters: Name Type Description bbin Object JSON input \"BB file\" with goal details Members &lt;static&gt; DPTYPE :number Enum object to identify different types of datapoints. Type: number Properties: Name Type Default Description AGGPAST number 0 AGGFUTURE number 1 RAWPAST number 2 RAWFUTURE number 3 FLATLINE number 4 HOLLOW number 5 alldata Holds all of current goal's datapoints allvals Holds datapoint values associated with each day data Holds current goal's aggregated datapoints derails Holds an array of derailments flad Holds the flattened datapoint fuda Holds all datapoints into the future goal Holds current goal's information id beebrain object ID for the current instance oresets Holds an array of odometer resets roads Holds the current array of road segments. The format for this object is an array of linear segments, each of which is an object with the following format: `{sta: [t, v], end: [t, v], slope: r, auto: autoparam}`, where `r` is expressed in Hertz (1/s), and `autoparam` is one of the enumerated values in broad.RP, indicating which entry will be auto-computed. Note that the end point for one segment is required to be identical to the starting point for the next segment. rosydata Holds current goal's preprocessed rosy datapoints Methods getStats() Returns an object with pre-computed goal statistics, summaries and other details. reloadRoad() Initiates reprocessing of a newly changed road, recomputing associated goal stats and internal details. setRoadObj() Sets a new road object for beebrain. Should be followed by a call to reloadRoad() to perform a recomputation of goal stats. Used by the road editor implemented by the bgraph module. &lt;inner&gt; computeRosy() Pre-compute rosy datapoints &lt;inner&gt; genStats() Process goal details &lt;inner&gt; initGlobals() Initialize various global variables before use &lt;inner&gt; legacyIn(p) Convery legacy parameters to up-to-date entries Parameters: Name Type Description p Object Goal parameters from the bb file &lt;inner&gt; legacyOut(p) Last in genStats, filter params for backward compatibility Parameters: Name Type Description p Object Computed goal statistics &lt;inner&gt; procData() Process goal data Coming here, we assume that data has entries with the following format:[t, v, comment, original index, v(original)] Coming out, datapoints have the following format: [t, v, comment, type, prevt, prevv, v(original) or null] Each point also records coordinates for the preceding point to enable connecting plots such as steppy and rosy even after filtering based on visibility in graph &lt;inner&gt; procParams() Process goal parameters. &lt;inner&gt; procRoad(json) Extracts road segments from the supplied road matrix in the * input parameters as well as tini and vini. Upon compeltion, the * 'roads' variable contains an array of road segments as javascript objects in the following format: {sta: [startt, startv], end: [endt, endv], slope, auto} Initial and final flat segments are added from starting days before tini and ending after 100 days after tfin. Parameters: Name Type Description json Array Unprocessed road matrix from the BB file &lt;inner&gt; setDefaultRange() Set any of {tmin, tmax, vmin, vmax} that don't have explicit values. Duplicates pybrain setRange() behavior &lt;inner&gt; stampIn(p, d) Processes fields with timestamps in the input Parameters: Name Type Description p Object Goal parameters from the BB file d Array Data points from the BB file &lt;inner&gt; stampOut(p) Convert unixtimes back to daystamps Parameters: Name Type Description p Object Computed goal statistics &lt;inner&gt; vetParams() Sanity check the input parameters. Return non-empty string if it fails. × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"bgraph.html":{"id":"bgraph.html","title":"Class: bgraph","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Class: bgraph bgraph bgraph new bgraph(options) bgraph object constructor. Creates an empty beeminder graph and/or road matrix table with the supplied options. Particular goal details may later be loaded with bgraph~loadGoal or loadGoalFromURL functions. Parameters: Name Type Description options BGraphOptions JSON input with various graph options Members clearUndo Clears the undo buffer. May be useful after the new road is submitted to Beeminder and past edits need to be forgotten. id bgraph object ID for the current instance Methods animAura(enable) Animates the aura element in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animBuf(enable) Animates the waterbuf element in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animBux(enable) Animates the waterbux element in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animData(enable) Animates datapoints in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animGuides(enable) Animates guideline elements in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animHor(enable) Animates the Akrasia horizon element in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animMav(enable) Animates the moving average in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animRosy(enable) Animates the rosy line in the graph Parameters: Name Type Description enable Boolean Enables/disables animation animYBR(enable) Animates the Yellow Brick Road elements in the graph Parameters: Name Type Description enable Boolean Enables/disables animation commitTo(newSlope) Dials the road to the supplied slope starting from the akrasia horizon Parameters: Name Type Description newSlope Number New road slope to start in a week curState() Returns current goal state Returns: Current goal state as [t, v, r, rdf(t)] or null if no goal Type object getGoalConfig() Returns properties for the currently loaded goal See: bgraph#getVisualConfig Returns: Type GoalProperties getRoad() Returns an object with an array ('road') containing the current roadmatix (latest edited version), as well as the following members: valid: whether the edited road intersects the pink region or not loser: whether the edited road results in a derailed goal or not asof: unix timestamp for \"now\" horizon: unix timestamp for the current akrasia horizon siru: seconds in rate units getRoadObj() Returns the road matrix object (in the internal format) for the goal. Primarily used to synchronize two separate graph instances on the same HTML page. See: bgraph#setRoadObj Returns: Internal road object Type object getVisualConfig() Returns visual properties for the currently loaded goal See: bgraph#getGoalConfig Returns: Type GoalVisuals hide() Informs the module instance that the element containing the visuals will be hidden. Internally, this prevents calls to getBBox(), eliminating associated exceptions and errors. See: bgraph#show isLoser() Checks whether the goal is currently a loser Returns: Type Boolean keepIntervals(flag) Sets/gets the keepIntervals option Parameters: Name Type Description flag Boolean Set/reset the option keepSlopes(flag) Sets/gets the keepSlopes option Parameters: Name Type Description flag Boolean Set/reset the option loadGoal(url) Initiates loading a new goal from the indicated url. Expected input format is the same as beebrain. Once the input file is fetched, the goal graph and road matrix table are updated accordingly. Parameters: Name Type Description url String URL to load the goal BB file from loadGoalJSON(json) Initiates loading a new goal from the supplied object. Expected input format is the same as beebrain. The goal graph and road matrix table are updated accordingly. Parameters: Name Type Description json object Javascript object containing the goal BB file contents maxDataDays() Sets/gets the maxDataDays option. Updates the datapoint display if the option is changed. msg(msg) Displays the supplied message overlaid towards the top of the graph Parameters: Name Type Description msg String Message to be displayed. Pass null to remove existing message. redo() Redoes the last edit that was undone retroRatchet(days) Performs retroratcheting function by adding new knots to leave \"days\" number of days to derailment based on today data point (which may be flatlined). Parameters: Name Type Description days Number Number of buffer days to preserve reverseTable(flag) Sets/gets the reverseTable option. Updates the table if the option is changed. Parameters: Name Type Description flag Boolean Set/reset the option saveGraph( [linkelt]) Generates a data URI downloadable from the link element supplied as an argument. If the argument is empty or null, replaces page contents with a cleaned up graph suitable to be used with headless chrome --dump-dom to retrieve the contents as a simple SVG. Parameters: Name Type Argument Default Description linkelt object &lt;optional&gt; null Element to provide a link for the SVG object to download. If null, current page contents are replaced. scheduleBreak(start, days, insert) Schedules a break starting from a desired point beyond the akrasia horizon and extending for a desired number of days. Parameters: Name Type Description start String Day to start the break, formatted as YYYY-MM-DD days Number Number of days fof the break insert Boolean Whether to insert into or overwrite onto the current road setRoadObj(newroad [, resetinitial]) Sets the road matrix (in the internal format) for the goal. Primarily used to synchronize two separate graph instances on the same HTML page. Should only be called with the return value of bgraph#getRoadObj. Parameters: Name Type Argument Default Description newroad object Road object returned by bgraph#getRoadObj resetinitial Boolean &lt;optional&gt; true Whether to set the internal \"initial road\" as well See: bgraph#getRoadObj show() Informs the module instance that the element containing the visuals will be shown again. This forces an update of all visual elements, which might have previously been incorrectly rendered if hidden. See: bgraph#hide showContext(flag) Sets/gets the showContext option Parameters: Name Type Description flag Boolean Set/reset the option showData(flag) Sets/gets the showData option Parameters: Name Type Description flag Boolean Set/reset the option tableAutoScroll(flag) Sets/gets the tableAutoScroll option. Parameters: Name Type Description flag Boolean Set/reset the option tableUpdateOnDrag(flag) Sets/gets the tableUpdateOnDrag option. Parameters: Name Type Description flag Boolean Set/reset the option undo() Undoes the last edit undoBufferState() Returns an object with the lengths of the undo and redo buffers xlinkLoaded() Returns a flag indicating whether external image references on the svg have finished loading or not zoomAll() Zooms out the goal graph to make the entire range from tini to tfin visible, with additional slack before and after to facilitate adding new knots. zoomDefault() Brings the zoom level to include the range from tini to slightly beyond the akrasia horizon. This is expected to be consistent with beebrain generated graphs. &lt;inner&gt; loadGoal(json) Loads goal details from the supplied JSON input and populates the graph and road matrix table with necessary components based on initially supplied options Parameters: Name Type Description json Object JSON object with the contents of a BB file, directly fed to a beebrain object instance. &lt;inner&gt; showOverlay() Utility function to show a shaded overlay with a message consisting of multiple lines supplied in the array argument &lt;inner&gt; startAnim() This function initiates a cyclic animation on a particular element, cycling through the attribute and style information supplied in two arrays. Each array is expected to include triples [name, v1, v0], cycling an attribute or style with 'name' up to the v1 value in 'dur' milliseconds and back to v0 in 'dur' milliseconds again, repeating indefinitely × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"bsandbox.html":{"id":"bsandbox.html","title":"Class: bsandbox","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Class: bsandbox bsandbox bsandbox new bsandbox(div) bsandbox object constructor. Creates a beeminder sandbox object, creating a graph on the supplied DIV object in the DOM. Parameters: Name Type Description div object object on the DOM to create a module:bgraph instance on Members id bsandbox object ID for the current instance Methods newData(v, c) Enters a new datapoint to the sandbox goal on the current day Parameters: Name Type Description v Number Datapoint value c String Datapoint comment. Auto-generated if empty string newGoal(gtype, runits, rate, vini, buffer) Creates a fresh new goal, replacing the DIV contents with a new graph. Parameters: Name Type Description gtype String Goal type. One of the following: \"hustler\", \"fatloser\", \"biker\", \"drinker\", \"gainer\", \"inboxer\". runits String Rate units. One of \"d\", \"w\", \"m\", \"y\" rate Number Initial road slope in runits vini Number Initial value of the road buffer Boolean Whether to have an initial week-long buffer or not newRate(r) Dials the road slope for the sandbox goal beyond the akrasia horizon Parameters: Name Type Description r Number New rate in runits nextDay() Advances the sandbox goal to the next day. Increments asof by 1 day. × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"module-beebrain.html":{"id":"module-beebrain.html","title":"Module: beebrain","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Module: beebrain Javascript implementation of beebrain, provided as a UMD module. Provides a beebrain class, which can be used to construct independent beebrain objects each with their own internal state. Copyright © 2017 Uluc Saranli Requires module:moment module:butil module:broad Classes beebrain × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"module-bgraph.html":{"id":"module-bgraph.html","title":"Module: bgraph","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Module: bgraph Javascript implementation of graph generation and editing for beebrain, provided as a UMD module. Provides a bgraph class, which can be used to construct independent graph generating objects each with their own internal state, possibly linked to particular div elements on the DOM. Copyright © 2017 Uluc Saranli Requires module:d3 module:moment module:butil module:broad module:beebrain Classes bgraph × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"module-broad.html":{"id":"module-broad.html","title":"Module: broad","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Module: broad Javascript library of road utilities for beebrain, provided as a UMD module. Returns a \"broad\" object, whose public members provide a number of road related constants and functions. Does not hold any internal state. The following member variables and methods are provided: Copyright © 2018 Uluc Saranli Requires module:moment module:butil Members &lt;static&gt; AGGR :function Collection of functiont to perform datapoint aggregation Type: function Properties: Name Type Default Description last function first function min function max function truemean function uniqmean function mean function median function mode function trimmean function sum function jolly function binary function nonzero function bu.nonzero triangle function square function clocky function bu.clocky count function kyshoc function skatesum function cap1 function &lt;static&gt; RP :number Enum object to identify field types for road segments. Type: number Properties: Name Type Default Description DATE number 0 VALUE number 1 SLOPE number 2 Methods &lt;static&gt; aok() Whether the given point is on the road if the road has lane width l &lt;static&gt; autowiden() Increase the width if necessary for the guarantee that you can't lose tomorrow if you're in the right lane today. Specifically, when you first cross from right lane to wrong lane (if it happened from one day to the next), the road widens if necessary to accommodate that jump and then the road width stays fixed until you get back in the right lane. So for this function that means if the current point is in the wrong lane, look backwards to find the most recent one-day jump from right to wrong. That wrong point's deviation from the centerline is what to max the default road width with. &lt;static&gt; bufcap() What delta from the centerline yields n days of safety buffer till centerline? &lt;static&gt; copyRoad() Creates and returns a clone of the supplied road array &lt;static&gt; dtc() Days To Centerline: Count the integer days till you cross the centerline/tfin if nothing reported &lt;static&gt; dtd() Returns the number of days to derail for the current road TODO: There are some issues with computing tcur, vcur &lt;static&gt; fillroad() Takes road matrix (with last row appended) and fills it in. Also adds a column, n, giving the position (0, 1, or 2) of the original null. &lt;static&gt; fillroadall() Version of fillroad that assumes tini/vini is the first row of road &lt;static&gt; findSeg() Finds index for the road segment containing the supplied x value &lt;static&gt; fixRoadArray() Recomputes the road array starting from the first node and assuming that the one of slope, enddate or endvalue parameters is chosen to be automatically computed. If usematrix is true, autocompute parameter selections from the road matrix are used &lt;static&gt; gapFill() Used with grAura() and for computing mean and meandelt, this adds dummy datapoints on every day that doesn't have a datapoint, interpolating linearly. &lt;static&gt; gdelt() Good delta: Returns the delta from the given point to the centerline of the road but with the sign such that being on the good side of the road gives a positive delta and being on the wrong side gives a negative delta. &lt;static&gt; interpData() Assumes both datapoints and the x values are sorted &lt;static&gt; lim() The value of the relevant/critical edge of the YBR in n days &lt;static&gt; limd() The bare minimum needed from vcur to the critical edge of the YBR in n days &lt;static&gt; noisyWidth() For noisy graphs, compute the lane width (or half aura width) based on data. Specifically, get the list of daily deltas between all the points, but adjust each delta by the road rate (eg, if the delta is equal to the delta of the road itself, that's an adjusted delta of 0). Return the 90% quantile of those adjusted deltas. &lt;static&gt; printRoad(rd) Pretty prints a given array of road segments. Parameters: Name Type Description rd Array Array of road segment objects &lt;static&gt; rdf() Computes the value of a road array at the given timestamp &lt;static&gt; rtf() Computes the slope of the supplied road array at the given timestamp &lt;static&gt; sameRoads(rda, rdb) Checks whether two road arrays are identical with nearEq segments. Parameters: Name Type Description rda First array fo road segments rdb Second array fo road segments &lt;static&gt; segSlope() Computes the slope of the supplied road segment &lt;static&gt; segValue() Computes the value of a road segment at the given timestamp &lt;static&gt; smooth() Return a pure function that fits the data smoothly, used by grAura &lt;static&gt; tvr() Given the endpt of the last road segment (tp,vp) and 2 out of 3 of t = goal date for a road segment (unixtime) v = goal value r = rate in hertz (s^-1), ie, road rate per second return the third, namely, whichever one is passed in as null. &lt;static&gt; vertseg() Whether the road has a vertical segment at time t × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"module-bsandbox.html":{"id":"module-bsandbox.html","title":"Module: bsandbox","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Module: bsandbox Javascript implementation of a sandbox for Beeminder goals, provided as a UMD module. Provides a bsandbox class, which can be used to construct independent sandbox objects each with their own graph object, linked to particular div element on the DOM. Copyright © 2017 Uluc Saranli Requires module:d3 module:moment module:butil module:broad module:beebrain module:bgraph Classes bsandbox × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"module-butil.html":{"id":"module-butil.html","title":"Module: butil","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Module: butil Javascript library of general purpose utilities for beebrain, provided as a UMD module. Provides a \"butil\" object, which holds various constants and utility functions to be used. Does not hold any internal state. Copyright © 2018 Uluc Saranli Requires module:moment Members &lt;static&gt; AKH :Number Akrasia horizon, in seconds Type: Number &lt;static&gt; BBURL :String Base URL for images. Type: String &lt;static&gt; BDUSK :Number ~2038, rails's ENDOFDAYS+1 (was 2^31-2weeks) Type: Number &lt;static&gt; Cols :string Beeminder colors for datapoints Type: string Properties: Name Type Default Description DYEL string #ffff44 LYEL string #ffff88 ROSE string #ff8080 AKRA string #4C4Cff PURP string #B56bb5 BLUE string #EAEAFF GRUE string #b5ffDE ORNG string #ff8000 WITE string #ffffff BIGG string #ffe54c PINK string #ffe5e5 PNKE string #ffcccc GRAY string #f0f0f0 BLCK string #000000 GRNDOT string #00aa00 BLUDOT string #3f3fff ORNDOT string #ffa500 REDDOT string #ff0000 &lt;static&gt; DIY :Number Days in year Type: Number &lt;static&gt; SECS :Number Number of seconds in a year, month, etc Type: Number Properties: Name Type Default Description y Number m Number w Number d Number self.SID h Number 3600 &lt;static&gt; SID :Number Seconds in day Type: Number &lt;static&gt; UNAM :string Unit names Type: string Properties: Name Type Default Description y string year m string month w string week d string day h string hour Methods &lt;static&gt; accumulate(l) Return a list with the cumulative sum of the elements in l, left to right Parameters: Name Type Description l Array.&lt;Number&gt; &lt;static&gt; addDays(m, days) Returns a new date object ahead by the specified number of days (uses moment) Parameters: Name Type Description m moment Moment object days Number Number of days to add &lt;static&gt; argmax(f, dom) Applies f on elements of dom, picks the maximum and returns the domain element that achieves that maximum. Parameters: Name Type Description f function Filter function dom Array Array with domain elements &lt;static&gt; arrayEquals(a1, a2) Deep compares array a1 and a2 for equality. Does not work on objects within the array Parameters: Name Type Description a1 Array First array a2 Array Second array &lt;static&gt; arrMax(arr) Returns maximum from an array of numbers Parameters: Name Type Description arr Array.&lt;Number&gt; Input array &lt;static&gt; arrMin(arr) Returns minimum from an array of numbers Parameters: Name Type Description arr Array.&lt;Number&gt; Input array &lt;static&gt; born(x) true if boolean or null Parameters: Name Type Description x &lt;static&gt; chop(x [, delta]) Return 0 when x is very close to 0. Parameters: Name Type Argument Default Description x Number Input number delta Number &lt;optional&gt; 1e-7 Tolerance &lt;static&gt; clip(x, a, b) clip(x, a,b) = min(b,max(a,x)). Swaps a and b if a &gt; b. Parameters: Name Type Description x Number Input number a Number left boundary b Number right boundary &lt;static&gt; clocky(a) Sum of differences of pairs, eg, [1,2,6,9] -&gt; 2-1 + 9-6 = 1+3 = 4 Parameters: Name Type Description a Array.&lt;Number&gt; Input list &lt;static&gt; cvx(x, a, b, c, d [, clipQ]) Convex combination: x rescaled to be in [c,d] as x ranges from a to b. clipQ indicates whether the output value should be clipped to [c,d]. Unsorted inputs [a,b] and [c,d] are also supported and work in the expected way except when clipQ = false, in which case [a,b] and [c,d] are sorted prior to computing the output. Parameters: Name Type Argument Default Description x Number Input in [a,b] a Number Left boundary of input b Number Right boundary of input c Number Left boundary of output d Number Right boundary of output clipQ Boolean &lt;optional&gt; true When false, sort a,b and c,d first &lt;static&gt; dayify(t [, sep]) Take an integer unixtime in seconds and return a daystamp like \"20170531\" (dreev superficially confirmed this works) Uluc: Added option to choose a separator Parameters: Name Type Argument Default Description t Number Integer unix timestamp sep String &lt;optional&gt; '' Separator character to use &lt;static&gt; dayparse(s [, sep]) Take a daystamp like \"20170531\" and return unixtime in seconds (dreev confirmed this seems to match Beebrain's function) Parameters: Name Type Argument Default Description s String Daystamp as a string \"YYYY[s]MM[s]DD\" sep String &lt;optional&gt; '' Separator character &lt;static&gt; daysnap(ut) Fixes the supplied unixtime to 00:00:00 on the same day (uses moment) Parameters: Name Type Description ut Number Unix time &lt;static&gt; deldups(a [, idfun]) Delete Duplicates. The ID function maps elements to something that defines equivalence classes. Parameters: Name Type Argument Default Description a Array Input array idfun function &lt;optional&gt; (x=&gt;x) Function to map elements to an equivalence class &lt;static&gt; extend(fr, to, owr) Extends a destination object with propertiesfrom a source object, optionally overwriting existing elements Parameters: Name Type Description fr object Source object to object Destination object owr boolean If true, overwrite existing properties of the destination &lt;static&gt; foldlist(f, x, l) foldlist(f,x, [e1, e2, ...]) -&gt; [x, f(x,e1), f(f(x,e1), e2), ...] Parameters: Name Type Description f function Filter function that takes two arguments x First argument to the function l Array Array of second arguments to the function &lt;static&gt; formatDate(ut) Formats the supplied unix time as YYYY.MM.DD Parameters: Name Type Description ut Number Unix time &lt;static&gt; formatDateTime(ut) Formats the supplied unix time as YYYY.MM.DD HH.MM.SS Parameters: Name Type Description ut Number Unix time &lt;static&gt; ichop(x [, delta]) Return an integer when x is very close to an integer Parameters: Name Type Argument Default Description x Number Input number delta Number &lt;optional&gt; 1e-7 Tolerance &lt;static&gt; inrange(x, min, max) Whether min Parameters: Name Type Description x Number min Number max Number &lt;static&gt; isArray(o) Returns true if input is an array Parameters: Name Type Description o Input parameter &lt;static&gt; linspace(a, b, n) Returns an array with n elements uniformly spaced between a and b Parameters: Name Type Description a Number Left boundary b Number Right boundary n Number Number of samples &lt;static&gt; listy(x) true if Array Parameters: Name Type Description x &lt;static&gt; loadJSON(url) Returns a promise that loads a JSON file from the supplied URL. Resolves to null on error, parsed JSON object on success. Parameters: Name Type Description url String URL to load JSON from &lt;static&gt; mean(a) Arithmetic mean of values in list a Parameters: Name Type Description a Array.&lt;Number&gt; Input list &lt;static&gt; median(a) Median of values in list a Parameters: Name Type Description a Array.&lt;Number&gt; Input list &lt;static&gt; mode(a) Mode of values in list a Parameters: Name Type Description a Array.&lt;Number&gt; Input list &lt;static&gt; modf(f) Returns a list containing the fraction and integer parts of a float Parameters: Name Type Description f Number Input number &lt;static&gt; monotonize(l [, dir]) Takes a list like [1,2,1] and make it like [1,2,2] (monotone increasing) Or if dir==-1 then min with the previous value to make it monotone decreasing Parameters: Name Type Argument Default Description l Array.&lt;Number&gt; dir Number &lt;optional&gt; 1 Direction to monotonize: 1 or -1 &lt;static&gt; monthsnap(ut) Fixes the supplied unixtime to the first day 00:00:00 on the same month (uses moment) Parameters: Name Type Description ut Number Unix time &lt;static&gt; nearEq(a, b, eps) Whether abs(a-b) &lt; eps Parameters: Name Type Description a Number b Number eps Number &lt;static&gt; nonzero(a) Whether all elements in a list are zero Parameters: Name Type Description a Array.&lt;Number&gt; Input list &lt;static&gt; norn(x) true if numeric or null Parameters: Name Type Description x &lt;static&gt; nummy(n) true if valid float and finite Parameters: Name Type Description n &lt;static&gt; orderedq(l) Whether list l is sorted in increasing order. Parameters: Name Type Description l Array.&lt;Number&gt; Input list &lt;static&gt; partition(l, n, d) Partitions list l into sublists whose beginning indices are separated by d, and whose lengths are n. If the end of the list is reached and there are fewer than n elements, those are not returned. Parameters: Name Type Description l Array Input array n Number Length of each sublist d Number Sublist separation &lt;static&gt; quantile(l, q [, qt] [, issorted]) The qth quantile of values in l. For median, set q=1/2. See http://reference.wolfram.com/mathematica/ref/Quantile.html Author: Ernesto P. Adorio, PhD; UP Extension Program in Pampanga, Clark Field. Parameters: Name Type Argument Default Description l Array.&lt;Number&gt; Input array q Number Desired quantile, in range [0,1] qt Number &lt;optional&gt; 1 Type of quantile computation, Hyndman and Fan algorithm, integer between 1 and 9 issorted boolean &lt;optional&gt; false Flag to indicate whether the input array is sorted &lt;static&gt; sh1(x) shn(chop(x), 4, 2). See shn. Parameters: Name Type Description x Number Input &lt;static&gt; sh1c(x) shnc(chop(x), 4, 2). See shnc. Parameters: Name Type Description x Number Input &lt;static&gt; sh1s(x) shns(chop(x), 4, 2). See shns. Parameters: Name Type Description x Number Input &lt;static&gt; sh1sc(x) shnsc(chop(x), 4, 2). See shnsc. Parameters: Name Type Description x Number Input &lt;static&gt; shd(t) Show Date: take timestamp and return something like 2012.10.22 Parameters: Name Type Description t Number Unix timestamp &lt;static&gt; shdt(t) Show Date/Time: take timestamp and return something like 2012.10.22 15:27:03 Parameters: Name Type Description t Number Unix timestamp &lt;static&gt; shn(x [, t] [, d]) Show Number: convert number to string. Use at most d significant figures after the decimal point. Target t significant figures total (clipped to be at least i and at most i+d, where i is the number of digits in integer part of x). Parameters: Name Type Argument Default Description x Number Input number t Number &lt;optional&gt; 10 Total number of significant figures d Number &lt;optional&gt; 5 Number of significant figures after the decimal &lt;static&gt; shnc(x, errdir [, t] [, d]) Show Number, rounded conservatively (variant of shn where you pass which direction, +1 or -1, is safe to err on). Aka conservaround! Eg, shnc(.0000003, +1, 2) -&gt; .01 Parameters: Name Type Argument Default Description x Number Input number errdir Number Safe direction: +1 or -1 t Number &lt;optional&gt; 10 Total number of significant figures d Number &lt;optional&gt; 5 Number of significant figures after the decimal &lt;static&gt; shns(x [, t] [, d]) Show Number with Sign: include the sign explicitly. See shn. Parameters: Name Type Argument Default Description x Number Input number t Number &lt;optional&gt; 16 Total number of significant figures d Number &lt;optional&gt; 5 Number of significant figures after the decimal &lt;static&gt; shnsc(x, e [, t] [, d]) Same as shns but with conservarounding. Parameters: Name Type Argument Default Description x Number Input number e Number Safe direction: +1 or -1 t Number &lt;optional&gt; 16 Total number of significant figures d Number &lt;optional&gt; 5 Number of significant figures after the decimal &lt;static&gt; shr(r) Rate as a string. Parameters: Name Type Description r Number Rate &lt;static&gt; sint(x) Converts a number to an integer string. Parameters: Name Type Description x Number Input number &lt;static&gt; sorn(x) true if string or null Parameters: Name Type Description x &lt;static&gt; splur(n, noun [, nounp]) Singular or Plural: Pluralize the given noun properly, if n is not 1. Provide the plural version if irregular. Eg: splur(3, \"boy\") -&gt; \"3 boys\", splur(3, \"man\", \"men\") -&gt; \"3 men\" Parameters: Name Type Argument Default Description n Number Count noun String Noun to pluralize nounp String &lt;optional&gt; '' Irregular pluralization if present &lt;static&gt; stringy(x) true if string? Parameters: Name Type Description x &lt;static&gt; sum(l) Return a list with the sum of the elements in l Parameters: Name Type Description l list Input array &lt;static&gt; timy(x) true if valid time Parameters: Name Type Description x &lt;static&gt; torf(x) true if boolean Parameters: Name Type Description x &lt;static&gt; torn(x) true if valid time or null Parameters: Name Type Description x &lt;static&gt; toTitleCase(str) Changes first letter of each word to uppercase Parameters: Name Type Description str String Input string &lt;static&gt; yearsnap(ut) Fixes the supplied unixtime to the first day 00:00:00 on the same year (uses moment) Parameters: Name Type Description ut Number Unix time &lt;static&gt; ZFUN(x) Unary function that always returns zero Parameters: Name Type Description x &lt;static&gt; zip(av) zip([[1,2], [3,4]]) --&gt; [[1,3], [2,4]]. Parameters: Name Type Description av Array.&lt;Array&gt; Array of Arrays to zip × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"tutorial-beebrain_.html":{"id":"tutorial-beebrain_.html","title":"Tutorial: Using the beebrain class","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Using the beebrain class This tutorial describes the details and usage of the beebrain class provided as part of the Beeminder Javascript implementation. The beebrain module and the associated beebrain class allows anyone to load and process a beeminder goal file (aka BB file), which includes goal configuration information, as well as the associated road matrix and datapoints. Assuming that the required modules (moment, polyfit, butil, broad and beebrain) are preloaded, the following code illustrates the most basic usage &lt;!DOCTYPE html&gt; async function loadGoal() { let url=\"file:///path/file.bb\" var resp = await butil.loadJSON( url ) document.getElementById('bbjson').innerHTML=JSON.stringify(resp) let goalbb = new beebrain( resp ) let goalout = goalbb.getStats() document.getElementById('outjson').innerHTML=JSON.stringify(goalout) } loadGoal()Assuming that there are two div elements with ids bbjson and outjson, this script fills in their contents with the loaded BB file, as well as the beebrain output. Note that the beebrain constructor needs to be called with a javascript object with the contents of the BB file acquired through beebrain#getStats. Note that the same module can be used within a node server as well. The following code (assuming paths are adjusted to work with your setup and required dependencies are installed) should work with a node server: const fs = require('fs') const bu = require('butil.js') const br = require('broad.js') const bb = require('beebrain.js') var bbjson = JSON.parse(fs.readFileSync(testroad.bb', 'utf8')) var bbr = new bb(bbjson) console.log(bbr.getStats())Once the beebrain object is created, various internal variables are directly exposed as public members for efficiency. In particular, the following members may be useful: roads : Piecewise linear road representation. The format for this object is an array of linear segments, each of which is an object with the following format: {sta: [t, v], end: [t, v], slope: r, auto: autoparam}, where r is expressed in Hertz (1/s), and autoparam is one of the enumerated values in broad.RP, indicating which entry will be auto-computed. Note that the end point for one segment is required to be identical to the starting point for the next segment. Finally, initial and final flat segments are added during processing, 100 days before and after the initial and final road matrix components, respectively. goal : Goal parameters and computed details. This is a javascript object with all goal parameters and computed statistics as well as a number of internal computations. data : Aggregated (non-future) data points for each day with at least one entry, where each array element has the form [unixtime,aggvalue,comment,type,prevt,prevv,voriginal], where type is one of the values in beebrain.DPTYPE, prevt and prevv are the time and value of the previous data point (used to draw the steppy lines) and voriginal records the unmodified (e.g. non-cumulative) value of the datapoint (set to null when the aggregated value does not coincide with any of the manually entered data points). The last element is used by module:bgraph to display tooltips for datapoints with the originally entered data value. Note that this format is also used in beebrain#alldata and beebrain#rosydata with slight differences. fuda : \"Future\" data points, beyond \"today\" (i.e. asof). Has the same format as beebrain.data. alldata : An array of all data points entered by the user, where each entry is an array [unixtime,vtotal,comment,type,null,null,voriginal]. Fields have the same semantics as beebrain#data, except that the \"previous\" point is not defined and hence not recorded. Includes future data as well. rosydata : \"Rosy\" datapoints generated from aggregated data points. Each array entry has the form [unixtime,aggval_comment,type,prevt,prevv,voriginal]. Fields have the same semantics as beebrain#data, including the time and value of the previous point used to generate lines connecting the rosy dots. flad : Flatlined (predicted) data point for today. Has the format [unixtime, vppr, \"PPR\", DPTYPE.FLATLINE, prevt, prevv, null]. allvals : Set of values for each non-empty timestamp. For a given unixtime t, allvals[t] contains an array with entries of the form [vtotal, comment, voriginal]. oresets : Array of unix timestamps where odometer reset was performed derails : Array of unix timestamps where the goal derailed These variables should be only used in a read-only manner since their internal consistency is critical for other components of the Beeminder's Javascript library. An exception to this is the roads object, which can be edited externally, followed by a call to beebrain#reloadRoad. This forces the beebrain object to reprocess the goal with the new road and update its output and internal state. Finally, if one wants to directly change the current road matrix for this particular beebrain instance, this can be done by using the beebrain#setRoadObj method. This is often useful to keep two bgraph instances on the same web page consistent and synchronized. However, this is normally done through associated bgraph instances and not through beebrain instances. InternalsThe inner workings of the beebrain class closely mirror those of the python implementation of beebrain. The constructor first defines all private variables and methods, exported public functions and then calls the genStats() function. This function performs all goal processing to generate goal stats. Important functions (in calling order) are legacyIn(p) : Processes legacy parameters stampIn(p,d) : Performs timestamp conversion for inputs vetParams() : Verifies parameter sanity procData() : Processes datapoints procRoad() : Processes the road matrix and constructs the internal roads object computeRosy() : Pre-computes rosy datapoints stampOut(p) : Prepares timestamp values for output legacyOut(p) : Outputs legacy parameters There are of course numerous details on how and when various things are computed. Please refer to the code for details. × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"tutorial-bgraph_.html":{"id":"tutorial-bgraph_.html","title":"Tutorial: Using the bgraph class","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Using the bgraph class This tutorial describes the details and usage of the bgraph class provided as part of the Beeminder Javascript implementation. Basic Usage for Interactive GraphsThe bgraph module and the associated bgraph class allows programmers to create beeminder graph and road table objects rendered within particular div objects within a web page. Assuming that the required modules (d3, moment, polyfit, pikaday, butil, broad, beebrain) are preloaded, the following code illustrates the most basic usage var graph = new bgraph({divGraph: document.getElementById('graph'), svgSize: { width: 800, height: 600 }, focusRect: { x:0, y:0, width:800, height: 453 }, ctxRect: { x:0, y:453, width:800, height: 100 }, showContext: true}) graph.loadGoal( \"/path/slug.bb\" )This creates an interactive svg element within the supplied div element, containing all graph components. These include the graph itself and a \"context\" graph that shows the entire range of the goal for the above example. It is important that you specify the width and height styles of the div element that will contain the graph with &lt;div id=\"graph\" style=\"width:800px; height:600px\"&gt;&lt;/div&gt;The bgraph constructor accepts an options argument with type BGraphOptions, whose components control the behavior of the generated graph. In particular, the divGraph, divJSON and divTable options specify container div elements for the graph, goal json output and a road matrix table, respectively. A page with all three features enabled would look like the following image: Basic Usage for Road EditingSimilar to its usage to generate interactive graphs, the bgraph class also allows programmers to create an interactive road editor that allows both manipulation of the road on the graph, as well as edits on the road matrix through the table. To this end, the following Javascript code creates the editor on an existing div element on the page: var graph = new bgraph({divGraph: document.getElementById('editor'), svgSize: { width: 800, height: 600 }, focusRect: { x:0, y:0, width:800, height: 453 }, ctxRect: { x:0, y:453, width:800, height: 100 }, roadEditor: true, showContext: true}) graph.loadGoal( \"/path/slug.bb\" )This populates the supplied div element with the following content, including the interactive editor and the editable road matrix. The JSON output was excluded since editing the graph will change its contents. Below is an explanation of various components and features of this editor: Manipulating the road: The gray vertical lines (\"knots\") on the graph allow moving left/right the inflection points in the road, changing their time, The \"dots\" on the road allow moving up/down the inflection points on the road, changing their time, The lines connecting the black dots (\"road segments\") can also be grabbed and moved, allowing the user to change the slope of road segments, The 'x' buttons on top of each knot allow deletion of the corresponding knot, removing the associated inflection point on the road, You can left double click to create a new inflection point (knot/dot pair) on the road The road line appears to be black when it is \"valid\" (i.e. does not intersect the pink region), and appears to be red when it is \"invalid\" (i.e. intersects the pink region), Visual indicators: Datapoints for the goal are shown as small circles, The pink area below the graph shows the \"forbidden area\" up until a week from now, which the edited road is not allowed to intersect to remain valid, When you \"select\" any knot, dot or segment with a single left mouse click, the corresponding entry in the road matrix table will be highlighted and corresponding date,value,slope values displayed on tooltips, Moving around and zooming: You can zoom in/out with the scroll wheel on the mouse, and drag the graph left/right to focus on different time periods on the graph, The y-axis range for the graph is automatically computed to make all relevant components on the graph visible, The \"context\" graph at the bottom shows the entire range of the graph, together with the current area spanned by the top \"focus\" graph. You can move around and scale the blue region to change the focus area. Road matrix table: Each row in this table shows three fields, end date, end value and slope, associated with the preceding segment. Only two of the three fields are \"active\", with the third one inferred to be consistent with the rest of the road, Selecting any of the active fields highlights the corresponding knot, dot or segment on the graph, Selecting an inactive field activates it, but deactivates one of the previously active fields. You can hence determine which field from among the three should be inferred automatically, You can delete a road matrix row by using the \"del\" button, A new segment can be added using the \"add\" button, created in between the row with the button and the next These components allow the user to change any and all aspects of the road associated with a beeminder goal. Common Functions for both Graphs and the Editor loadGoal(url): Async function that loads the BB file from the indicated URL and starts rendering the graph. Completion of rendering might take some time, at the end of which the callback function specified in the onRoadChange property of BGraphOptions will be called. loadGoalJSON(json): Function to load goal contents from a BB json start rendering the graph. Completion of rendering might take some time, at the end of which the callback function specified in the onRoadChange property of BGraphOptions will be called. TODO: CHECK if onRoadChange is indeed called here zoomAll(): Zooms out to show the entire graph range zoomDefault(): Zooms into the default range for the graph hide() and bgraph#show(): Should be called when the div containing the graph/editor is hidden and reshown on the page. showContext(flag): Show/hide the context graph maxDataDays(days): Set the maximum number of days before today to show datapoints for. Defaults to -1 (show all) unless specified in the initial options. Helps optimize interactivity performance. reverseTable(flag): Sets whether the road matrix table should be sorted in decreasing (true), or increasing (false) order of dates. Final road row is placed at the top if set to true. getRoad(): Returns the road matrix array for the current (possibly edited) road as expected by Beeminder API road submission getRoadObj(): Returns a copy of the internal roads object from the beebrain instance for the current (possibly edited) road setRoadObj(): Sets the road matrix for the internal beebrain instance. Can be used to consistently coordinate two graph instances on a single page. isLoser(): Returns whether the current (possibly edited) road is a loser or not curState(): Returns the state [t,v,r,rdf(t)] of the goal for today (asof). saveGraph(linkelt): Generates a downloadable URI from the current SVG and links the supplied linkelt to it. If linkelt is null (default), replaces the current page with the SVG content alone. getVisualConfig(): Returns current settings for visual properties, as captured by the GoalVisuals datatype. getGoalConfig(): Returns current non-visual goal properties as captured by the GoalProperties datatype. Functions Specific to the Editor showData(flag): Show/hide datapoints on the editor graph. Datapoins are always shown on the interactive non-editor graph. keepSlopes(flag): When enabled, this forces road segment slopes to be preserved when moving knots and points around the editable graph. keepIntervals(flag): When enabled, this forces all intervals between successive knots to be preserved when moving a knot left/right. This allows keeping the entire road beyond the knot being dragged fixed during editing. tableAutoScroll(flag): When enabled, hovering over any knots, dots or segments forces the road matrix table to be scrolled such that the corresponding position is in the center undo(): Undoes the last edit redo(): Redoes the last undone edit undoBufferState(): Returns the lengths of the undo/redo buffers as {undo: undoBuffer.length, redo: redoBuffer.length} clearUndo(): Clears the undo and redo buffers. retroRatchet(days): Introduces a vertical road segment on today (asof) such that the goal only has \"days\" safety buffer left. scheduleBreak(start, days, insert): Schedules a break starting on \"start\" (formatted as YYYY-MM-DD) and lasting for \"days\" days. If insert=true, road components overlapping with the break are shifted forward. Existing road is overwritten otherwise. commitTo(newSlope): Changes the slope of the road to be \"newSlope\" beyond the akrasia horizon (a week from today) Functions Specific to Interactive Graphs animHor(enable): Enables/disables animation for the Akrasia Horizon animYBR(enable): Enables/disables animation for the Yellow Brick Road animData(enable): Enables/disables animation for datapoints animGuides(enable): Enables/disables animation for guidelines animRosy(enable): Enables/disables animation for the rosy line animMav(enable): Enables/disables animation for the moving average animAura(enable): Enables/disables animation for the aura animBuf(enable): Enables/disables animation for the safety buffer watermark animBux(enable): Enables/disables animation for the pledge amount × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "},"tutorial-bgraph_internals.html":{"id":"tutorial-bgraph_internals.html","title":"Tutorial: Internal details for the bgraph class","body":" Documentation Modules beebrainbgraphbroadbsandboxbutil Classes beebrainbgraphbsandbox Tutorials Using the beebrain classUsing the bgraph classInternal details for the bgraph class Global Global Internal details for the bgraph class This tutorial describes the internal details of the bgraph class provided as part of the Beeminder Javascript implementation. Structure of the SVG element hosting the graph svg: top element defs: Definitions references from the graph style: Overall style components for the SVG to support standalone loading clipPath (id=plotclip): Path for clipping the plot area clipPath (id=brushclip): Path for clipping the context plot clipPath (id=buttonAreaclip): Path for clipping knot removal buttons path (id=rightarrow): Right arrow shape (flatlined datapoint) path (id=downtarrow): Down arrow shape (derailment for yaw&gt;0) path (id=uparrow): Up arrow shape (derailment for yaw × Search results Close Documentation generated by JSDoc 3.5.5 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
