<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
</head>
<body>
<div id="test"></div>
<script>
const data = ['A', 'B', 'C'];

d3.select('#test')
  .selectAll('div')
  .data(data)
  .join('div')
  .text(d => d)
  .attr('contenteditable', true)
  .on('keydown', function(event, d) {
    // Method 1: Use d3.select(this) with .selectAll to find index
    const parent = this.parentNode;
    const siblings = Array.from(parent.children);
    const index = siblings.indexOf(this);

    console.log('Method 1 (Array.indexOf):', index);

    // Method 2: Use D3's nodes() and indexOf
    const selection = d3.select(parent).selectAll('div');
    const nodes = selection.nodes();
    const index2 = nodes.indexOf(this);

    console.log('Method 2 (D3 nodes):', index2);
    console.log('Datum:', d);
    console.log('---');
  });

console.log('Test ready. Type in one of the divs.');
</script>
</body>
</html>
