<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css">
    <link rel="stylesheet" href="pikaday.css">
    <link rel="stylesheet" href="roadeditor.css">
    <script src = "https://d3js.org/d3.v4.js"></script>
    <script src = "moment.min.js"></script>
    <script src = "pikaday.js"></script>
    <script src = "polyfit.js"></script>
</head>
<style>

</style>

<body>
  <div class="container">
    <h1>Beeminder Visual Road Editor and Client-Side Graphs</h1>
    <button class="btn btn-primary">
      <span class="octicon octicon-plus"></span>
    </button>
    <button class="icon-minus">
      <span class="octicon octicon-dash"></span>
    </button>
  </div>

</body>
  
  <script>
    function updateTableButtons() {
      var allrows = d3.select(opts.divTable)
            .selectAll(".rtable .startrow, .rtable .roadrow");
      var btncells = allrows.selectAll(".roadbtn")
            .data(function(row, i) {
              var kind;
              if (opts.reverseTable) kind = roads.length-2-i;
              else kind = i;
              return [
                {order: -1, row:kind, name: "btndel"+kind, evt: function() { alert("remove"); },
                 type: 'button', txt: 'del', auto: false},
                {order: 3, row:kind, name: "btndate"+kind, evt: function() { alert("disableDate"); },
                 type: 'checkbox', txt: 'r', auto: (row.auto==RP.DATE)},
                {order: 5, row:kind, name: "btnvalue"+kind, evt: function() { alert("disableValue"); },
                 type: 'checkbox', txt: 'r', auto: (row.auto==RP.VALUE)},
                {order: 7, row:kind, name: "btnslope"+kind, evt: function() { alert("disableSlope"); },
                 type: 'checkbox', txt: 'r', auto: (row.auto==RP.SLOPE)},
                {order: 8, row:kind, name: "btnadd"+kind, evt: function() { alert("addNew"); },
                 type: 'button', txt: 'ins', auto: false},
              ];
            });
      
      var newbtncells = btncells.enter().append("input")
            .attr('class', 'roadbtn')
            .attr('id', function(d) { return d.row;})
            .attr('name', function(d) { return d.name;})
            .attr('type',function(d) {return d.type;})
            .attr('value', function(d) { 
              let cell = "<span class='octicon octicon-plus'></span>"
              //return cell;
              return d.txt;})
            .on('click', function (d) {d.evt();});
      
      btncells.exit().remove();
      btncells = allrows.selectAll(".rtable .roadbtn");
      btncells
        .attr('id', function(d) { return d.row;})
        .attr('name', function(d) { return d.name;})
        .style('visibility', function(d,i) {
          return ((Number(d.row)>0 && Number(d.row)<(roads.length-2)) 
                  || i==4 
                  || (i>0 && Number(d.row)>0 ))?"visible":"hidden";
        })
        .property('checked', function(d) { return d.auto?true:false;});

      allrows.selectAll(".roadcell, .roadbtn, .startcell")
        .sort(function(a,b) {return a.order > b.order;});
    }

  </script>
</html>